This file works through the basic principle behind Total Field Inversion (TFI).
###### Paper source:
Liu et al.: Preconditioned Total Field Inversion (TFI) Method for Quantitative Susceptibility Mapping

#### Use of TFI:
* TFI is used in QSM MR image processing to optimize the picture.
- reduce systematic errors
- traditional QSM has: 

  - background field removal
  
  - local field inversion (LFI)

- improve QSM quality in presence of large susceptibility changes
- brain, air-filled sinus, skull, fat

#### Methods:
- single optimization problem
- simultaneously estimates
    * background fields
    * local fields
        -  prevents error propagation from background field removal to QSM
- uses new preconditioner to increase computational speed

### Introduction:
#### QSM:
- extracts spatial distribution tissue magnetic susc.
  * from gradient echo signal phase
- steps:
    1) background field removal
        - determine local field generated by tissue
    2) inversion from local field to tissue susceptibility

- challenges:
  * imprecise separation of background and tissue fields
    * caused by assumptions made in BFR methods
    * particularly problematic at large sucept. differences
      * tissue-air interfaces
  * presence of large susc. dynamic range within region of interest (ROI)
       * leads to streaking artifacts

- Laplacian-based QSM:
    - avoid separate fitting of background and local field
    - based on partial diff. formulation of forward signal equation
    - implicitly eliminates the background field
    - practical implementation trade off:
        - robustness to error amplification
        - integrity of visualized cortical brain tissue
    - necessary erosion of brain mask
        - prevents visualization of some structures at the boundary
        
### Theory:
#### QSM: 
- decomposes field into background and local field
    - local: magntic field gerneated by the susceptibility inside a given ROI
    - background: generated outside of ROI
- variety of background removal (BFR) techniques exist 
- regularization is used as local field  inversion (LFI)
- errors in background field propagate to subsequential local field
- here: use total field inversion (TFI)
    * estimate \\(\chi_B\\) and \chi_L jointly
    * their sum is the total susceptibility

#### TFI:
-  some algorithms slow down the process
* e.g. conjugate gradient (CG)
* solution: use prior-enhanced preconditioning to improve convergence
    * approximates covariance matrix
    * is right-handed
    * increases convergence speed
    * design: difference in matrix between voxel inside and outside M approx. same as
        * difference in susceptibility between local and background region 
    * thresholding of R2* :
        * account for strong susc. within M
        * assuming voxels with high R2* have high susceptibility
- compute final susceptibility
* using Gauss-Newton method
    
#### Laplacian- based QSM methods:
- some examples:
    1) single step QSM (SSQSM)
    2) differential QSM
- enable QSM reconstruction within single step
- always come with erosion of the ROI
    - depends on width of kernel how much
- background susceptibility disappears after application of Laplacian 

### Methods: 
- gives details on how to simulate, acquire etc


